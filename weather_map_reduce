# mapper for weather forcast
mapper.py
import sys

for line in sys.stdin:
    line = line.strip()
    parts = line.split(",")
    if parts[0] == "Year":
        continue
    if len(parts) == 4:
        year = parts[0]
        temperature = parts[3]
        print(f"{year}\t{temperature}")

reducer.py
import sys

current_year = None
max_temp = -9999

for line in sys.stdin:
    line = line.strip()
    year, temp = line.split("\t")
    temp = int(temp)
    
    if current_year == year:
        max_temp = max(max_temp, temp)
    else:
        if current_year:
            print(f"{current_year}\t{max_temp}")
        current_year = year
        max_temp = temp

if current_year:
    print(f"{current_year}\t{max_temp}")

weather.csv
Year,Month,Day,Temperature
2010,1,1,23
2010,1,2,25
2010,1,3,18
2010,1,4,20
2010,1,5,22
2010,2,1,24
2010,2,2,26
2010,2,3,19
2010,2,4,21
2010,2,5,23
2011,1,1,21
2011,1,2,24
2011,1,3,20
2011,1,4,22
2011,1,5,23
2011,2,1,25
2011,2,2,27
2011,2,3,22
2011,2,4,24
2011,2,5,26
2012,1,1,20
2012,1,2,22
2012,1,3,19
2012,1,4,21
2012,1,5,22
2012,2,1,23
2012,2,2,25
2012,2,3,20
2012,2,4,22
2012,2,5,24
2013,1,1,19
2013,1,2,21
2013,1,3,17
2013,1,4,20
2013,1,5,22
2013,2,1,24
2013,2,2,26
2013,2,3,23
2013,2,4,25
2013,2,5,27
2014,1,1,18
2014,1,2,20
2014,1,3,16
2014,1,4,19
2014,1,5,21
2014,2,1,22
2014,2,2,24
2014,2,3,19
2014,2,4,21
2014,2,5,23
2010,3,1,24
2010,3,2,26
2010,3,3,23
2010,3,4,25
2010,3,5,27
2011,3,1,22
2011,3,2,24
2011,3,3,21
2011,3,4,23
2011,3,5,25
2012,3,1,21
2012,3,2,23
2012,3,3,20
2012,3,4,22
2012,3,5,24
2013,3,1,23
2013,3,2,25
2013,3,3,22
2013,3,4,24
2013,3,5,26
2014,3,1,22
2014,3,2,24
2014,3,3,21
2014,3,4,23
2014,3,5,25
2010,4,1,26
2010,4,2,28
2010,4,3,25
2010,4,4,27
2010,4,5,29
2011,4,1,24
2011,4,2,26
2011,4,3,23
2011,4,4,25
2011,4,5,27
2012,4,1,23
2012,4,2,25
2012,4,3,22
2012,4,4,24
2012,4,5,26
2013,4,1,25
2013,4,2,27
2013,4,3,24
2013,4,4,26
2013,4,5,28
2014,4,1,24
2014,4,2,26
2014,4,3,23
2014,4,4,25
2014,4,5,27

